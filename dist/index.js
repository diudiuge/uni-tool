var K=Object.create;var x=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var M=(n,e)=>{for(var o in e)x(n,o,{get:e[o],enumerable:!0})},B=(n,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of z(e))!I.call(n,t)&&t!==o&&x(n,t,{get:()=>e[t],enumerable:!(r=V(e,t))||r.enumerable});return n};var h=(n,e,o)=>(o=n!=null?K(A(n)):{},B(e||!n||!n.__esModule?x(o,"default",{value:n,enumerable:!0}):o,n));var R=h(require("cac"));var p=require("path"),s=require("fs");var m=require("path"),a=require("fs"),_=h(require("magic-string")),j=0;function G(){return++j,`${global.i18n.config.prefix}${j}`}var d={},q=n=>{let e=(0,a.readdirSync)(n);e=e.filter(o=>!global.i18n.config.ignoreDirs.includes(o)),e.forEach(o=>{let r=(0,m.resolve)(n,o);if((0,a.statSync)(r).isDirectory())q((0,m.resolve)(n,o));else{let l=(0,a.readFileSync)(r,"utf-8");if(global.i18n.config.ignoreExts.includes((0,m.extname)(r||"")))return;let c=new _.default(l);c.replace(global.i18n.config.reg,(...g)=>{let f=G();return d=global.i18n.config.handlerResult(d,f,g),global.i18n.back?global.i18n.config.backHandler(d,f,g):global.i18n.config.handlerTemlpate(d,f,g)}),(0,a.writeFileSync)(r,c.toString())}})};function E(n){return q(n),d}var O=h(require("md5")),v=h(require("axios")),F=n=>(n=n.reduce((e,o)=>{if(e.length>0){let r=e.pop();return r.length<20?[...e,[...r,o]]:[...e,r,[o]]}return[...e,[o]]},[]),n),J=async(n,e,o)=>{try{let r=Object.values(n),t=Object.keys(n),l=F(r),c=F(t),g=l.map(i=>i.join(`
`)),f=[];for(let i=0;i<g.length;i++){let u=g[i],k=new Date().getTime(),H=global.i18n.config.appid+u+k+global.i18n.config.key,C=(0,O.default)(H),b=(await v.default.get("http://api.fanyi.baidu.com/api/trans/vip/translate",{params:{q:u,appid:global.i18n.config.appid,salt:k,from:e,to:o,sign:C}})).data;if(b&&b.error_code)throw new Error(b.error_code);f=[...f,...b.trans_result.map((w,D)=>{if(!c[i]||!c[i][D])throw new Error(JSON.stringify(w));return{key:c[i][D],item:w}})]}return f.reduce((i,u)=>({...i,[u.key]:u.item.dst}),{})}catch(r){console.log(r)}};var S={};M(S,{appid:()=>Q,backHandler:()=>tn,from:()=>W,getCacheFromJson:()=>T,handlerResult:()=>on,handlerTemlpate:()=>rn,ignoreDirs:()=>Y,ignoreExts:()=>Z,key:()=>U,prefix:()=>en,reg:()=>nn,to:()=>X});var L=require("fs"),P=require("path"),Q="",U="",W="cht",X=["en","zh"],Y=[".hbuilderx","node_modules","uni_modules","unpackage",".git","dist","static"],Z=[".woff2",".jpg",".png",".pdf",".keystore"],nn=new RegExp(/\$t\(('|"|`)(.*?)('|"|`)\)/g),en="i18n_",on=(n,e,[o,r,t,l])=>(n[e]=t,n),rn=(n,e,[o,r,t,l])=>`$t(${r}${e}${l})`,y,T=()=>{if(y)return y;let n=L.readFileSync(P.resolve(global.i18n.cacheDir,`./${global.i18n.cacheDir}.json`),"utf-8");return y=JSON.parse(n),y},tn=(n,e,[o,r,t,l])=>{let c=T();return`$t(${r}${c[e]?c[e]:""}${l})`};global.i18n={};global.i18n.config=S;async function N(){let n=process.cwd();if(global.i18n.cacheDir=(0,p.resolve)(n,".i18n"),(0,s.existsSync)((0,p.resolve)(global.i18n.cacheDir,"config.js"))){let o=require((0,p.resolve)(global.i18n.cacheDir,"config.js"));global.i18n.config=o}(0,s.existsSync)(global.i18n.cacheDir)||(0,s.mkdirSync)(global.i18n.cacheDir);let e=E(n);global.i18n.back||((0,s.writeFileSync)((0,p.resolve)(global.i18n.cacheDir,`${global.i18n.config.from}.json`),JSON.stringify(e,null,2)),global.i18n.config.to.forEach(async o=>{let r=await J(e,global.i18n.config.from,o);(0,s.writeFileSync)((0,p.resolve)(global.i18n.cacheDir,`${o}.json`),JSON.stringify(r,null,2))}))}var $=(0,R.default)();$.command("i18n","\u63D0\u53D6\u5F53\u524D\u9879\u76EE\u4E0B\u591A\u8BED\u8A00\u7684\u6587\u672C\uFF0C \u8FDB\u884C\u5904\u7406\u5E76\u7FFB\u8BD1").option("back","\u56DE\u9000\u4EE3\u7801").action(async({back:n})=>{global.i18n.back=n,N()});$.help();$.parse();
//# sourceMappingURL=index.js.map